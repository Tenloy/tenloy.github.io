<!DOCTYPE html>
<html lang="en">
    <!-- title -->




<!-- keywords -->




<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" >
    <meta name="author" content="Tenloy">
    <meta name="renderer" content="webkit">
    <meta name="copyright" content="Tenloy">
    
    <meta name="keywords" content="Tenloy,iOS,Swift">
    
    <meta name="description" content="学习 生活 记录 回忆">
    <meta name="description" content="前言：内容大幅度参考了网上一些博客 + 亲自实践。若文末忘记注明出处，请见谅，留言修改。 一、为什么制作马甲？ 防止app因为违规被苹果下架后”一无所有”。付费视频类，彩票类的app多少都会违反苹果的一些规范有被下架的风险，马甲包可以在app被下架的时候顶上去，那什么情况下会被下架呢？  之前审核的时候用到开关，审核过了之后APP的内容和审核时的内容差异较大，苹果复查的时候发现被下架 用户举报，被">
<meta property="og:type" content="article">
<meta property="og:title" content="iOS制作马甲总结">
<meta property="og:url" content="https://tenloy.github.io/2020/06/13/ios-vest.html">
<meta property="og:site_name" content="Tenloy&#39;s Blog">
<meta property="og:description" content="前言：内容大幅度参考了网上一些博客 + 亲自实践。若文末忘记注明出处，请见谅，留言修改。 一、为什么制作马甲？ 防止app因为违规被苹果下架后”一无所有”。付费视频类，彩票类的app多少都会违反苹果的一些规范有被下架的风险，马甲包可以在app被下架的时候顶上去，那什么情况下会被下架呢？  之前审核的时候用到开关，审核过了之后APP的内容和审核时的内容差异较大，苹果复查的时候发现被下架 用户举报，被">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://tenloy.github.io/images/ios/vest/15402030163246.jpg">
<meta property="og:image" content="https://tenloy.github.io/images/ios/vest/15402873574819.jpg">
<meta property="og:image" content="https://tenloy.github.io/images/ios/vest/15402721412482.gif">
<meta property="og:image" content="https://tenloy.github.io/images/ios/vest/15402749967715.jpg">
<meta property="og:image" content="https://tenloy.github.io/images/ios/vest/15402820640765.jpg">
<meta property="og:image" content="https://tenloy.github.io/images/ios/vest/15402815261872.jpg">
<meta property="og:image" content="https://tenloy.github.io/images/ios/vest/15403674704990.jpg">
<meta property="og:image" content="https://tenloy.github.io/images/ios/vest/15402867506913.jpg">
<meta property="og:image" content="https://tenloy.github.io/images/ios/vest/15402864436528.jpg">
<meta property="og:image" content="https://tenloy.github.io/images/ios/vest/15403733934272.jpg">
<meta property="og:image" content="https://tenloy.github.io/images/ios/vest/15403735367044.jpg">
<meta property="og:image" content="https://tenloy.github.io/images/ios/vest/15403741982298.jpg">
<meta property="og:image" content="https://tenloy.github.io/images/ios/vest/15403742042150.jpg">
<meta property="og:image" content="https://tenloy.github.io/images/ios/vest/15403757992100.jpg">
<meta property="og:image" content="https://tenloy.github.io/images/ios/vest/15403763613907.jpg">
<meta property="article:published_time" content="2020-06-13T03:30:00.000Z">
<meta property="article:modified_time" content="2023-05-04T10:02:35.644Z">
<meta property="article:author" content="Tenloy">
<meta property="article:tag" content="Tenloy, iOS, Tenloy Blog, 博客，Swift, 编译, 计算机">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tenloy.github.io/images/ios/vest/15402030163246.jpg">
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    
    <title>iOS制作马甲总结 · Tenloy&#39;s Blog</title>
    <style type="text/css">
    @font-face {
        font-family: 'Oswald-Regular';
        src: url("/font/Oswald-Regular.ttf");
    }

    body {
        margin: 0;
    }

    header,
    footer,
    .back-top,
    .sidebar,
    .container,
    .site-intro-meta,
    .toc-wrapper {
        display: none;
    }

    .site-intro {
        position: relative;
        z-index: 3;
        width: 100%;
        /* height: 50vh; */
        overflow: hidden;
    }

    .site-intro-placeholder {
        position: absolute;
        z-index: -2;
        top: 0;
        left: 0;
        width: calc(100% + 300px);
        height: 100%;
        background: repeating-linear-gradient(-45deg, #444 0, #444 80px, #333 80px, #333 160px);
        background-position: center center;
        transform: translate3d(-226px, 0, 0);
        animation: gradient-move 2.5s ease-out 0s infinite;
    }

    @keyframes gradient-move {
        0% {
            transform: translate3d(-226px, 0, 0);
        }
        100% {
            transform: translate3d(0, 0, 0);
        }
    }

</style>

    <link rel="preload" href= "/css/style.css?v=20180824" as="style" onload="this.onload=null;this.rel='stylesheet'" />
    <link rel="stylesheet" href= "/css/mobile.css?v=20180824" media="(max-width: 980px)">
    
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'" />
    
    <!-- /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
/* This file is meant as a standalone workflow for
- testing support for link[rel=preload]
- enabling async CSS loading in browsers that do not support rel=preload
- applying rel preload css once loaded, whether supported or not.
*/ -->
<script>
(function( w ){
	"use strict";
	// rel=preload support test
	if( !w.loadCSS ){
		w.loadCSS = function(){};
	}
	// define on the loadCSS obj
	var rp = loadCSS.relpreload = {};
	// rel=preload feature support test
	// runs once and returns a function for compat purposes
	rp.support = (function(){
		var ret;
		try {
			ret = w.document.createElement( "link" ).relList.supports( "preload" );
		} catch (e) {
			ret = false;
		}
		return function(){
			return ret;
		};
	})();

	// if preload isn't supported, get an asynchronous load by using a non-matching media attribute
	// then change that media back to its intended value on load
	rp.bindMediaToggle = function( link ){
		// remember existing media attr for ultimate state, or default to 'all'
		var finalMedia = link.media || "all";

		function enableStylesheet(){
			link.media = finalMedia;
		}

		// bind load handlers to enable media
		if( link.addEventListener ){
			link.addEventListener( "load", enableStylesheet );
		} else if( link.attachEvent ){
			link.attachEvent( "onload", enableStylesheet );
		}

		// Set rel and non-applicable media type to start an async request
		// note: timeout allows this to happen async to let rendering continue in IE
		setTimeout(function(){
			link.rel = "stylesheet";
			link.media = "only x";
		});
		// also enable media after 3 seconds,
		// which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
		setTimeout( enableStylesheet, 3000 );
	};

	// loop through link elements in DOM
	rp.poly = function(){
		// double check this to prevent external calls from running
		if( rp.support() ){
			return;
		}
		var links = w.document.getElementsByTagName( "link" );
		for( var i = 0; i < links.length; i++ ){
			var link = links[ i ];
			// qualify links to those with rel=preload and as=style attrs
			if( link.rel === "preload" && link.getAttribute( "as" ) === "style" && !link.getAttribute( "data-loadcss" ) ){
				// prevent rerunning on link
				link.setAttribute( "data-loadcss", true );
				// bind listeners to toggle media back
				rp.bindMediaToggle( link );
			}
		}
	};

	// if unsupported, run the polyfill
	if( !rp.support() ){
		// run once at least
		rp.poly();

		// rerun poly on an interval until onload
		var run = w.setInterval( rp.poly, 500 );
		if( w.addEventListener ){
			w.addEventListener( "load", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		} else if( w.attachEvent ){
			w.attachEvent( "onload", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		}
	}


	// commonjs
	if( typeof exports !== "undefined" ){
		exports.loadCSS = loadCSS;
	}
	else {
		w.loadCSS = loadCSS;
	}
}( typeof global !== "undefined" ? global : this ) );
</script>

    <link rel="icon" href= "/assets/favicon.ico" />
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js" as="script" />
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js" as="script" />
    <link rel="preload" href="/scripts/main.js" as="script" />
    <link rel="preload" as="font" href="/font/Oswald-Regular.ttf" crossorigin>
    <link rel="preload" as="font" href="https://at.alicdn.com/t/font_327081_1dta1rlogw17zaor.woff" crossorigin>
    
        <!-- algolia -->
        <script>
            
            var hits = JSON.parse('{"per_page":10}')
            var labels = JSON.parse('{"input_placeholder":"Search for Posts","hits_empty":"没有找到任何搜索结果: ${query}","hits_stats":"找到约${hits}条结果（用时${time}ms）"}')

            var algolia = {
                applicationID: 'V0HYXBS9FB',
                apiKey: '6550d5de786935564142097c3e78c380',
                indexName: 'law_blog_index',
                hits: hits,
                labels: labels
            }
        </script>
    
    <!-- fancybox -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" defer></script>
    <!-- 百度统计  -->
    
    <!-- 谷歌统计  -->
    
<meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/atom.xml" title="Tenloy's Blog" type="application/atom+xml">
</head>

    
        <body class="post-body">
    
    
<header class="header">

    <div class="read-progress"></div>
    <div class="header-sidebar-menu">&#xe775;</div>
    <!-- post页的toggle banner  -->
    
    <div class="banner">
            <div class="blog-title">
                <a href="/" >Tenloy&#39;s Blog</a>
            </div>
            <div class="post-title">
                <a href="#" class="post-name">iOS制作马甲总结</a>
            </div>
    </div>
    
    <!-- 将home-link的操作改为应用到header-top-right上 -->
    <div class="header-top-right">
        <!-- search  -->
        
            <div class="site-search popup-trigger tl-search">
                <span class="iconfont-jian tl-search-icon">&#xe7fc;搜索</span>
            </div>
            
        <a class="home-link" href=/>Tenloy's Blog</a>
    </div>
</header>
    <div class="wrapper">
        <div class="site-intro" style="







height:40vh;
">
    
    <!-- 主页  -->
    
    
    <!-- 404页  -->
            
    <div class="site-intro-placeholder"></div>
    <div class="site-intro-img" style="background-image: url(/intro/post-bg.jpg)"></div>
    <div class="site-intro-meta">
        <!-- 标题  -->
        <h1 class="intro-title">
            <!-- 主页  -->
            
            iOS制作马甲总结
            <!-- 404 -->
            
        </h1>
        <!-- 副标题 -->
        <p class="intro-subtitle">
            <!-- 主页副标题  -->
            
            
            <!-- 404 -->
            
        </p>
        <!-- 文章页meta -->
        
            <div class="post-intros">
                <!-- 文章页标签  -->
                
                
                    <div class="post-intro-read">
                        <span>Word count: <span class="post-count word-count">7.4k</span>Reading time: <span class="post-count reading-time">28 min</span></span>
                    </div>
                
                <div class="post-intro-meta">
                    <span class="post-intro-calander iconfont-archer">&#xe676;</span>
                    <span class="post-intro-time">2020/06/13</span>
                    
                    <span id="busuanzi_container_page_pv" class="busuanzi-pv">
                        <span class="iconfont-archer">&#xe602;</span>
                        <span id="busuanzi_value_page_pv"></span>
                    </span>
                    
                    <span class="shareWrapper">
                        <span class="iconfont-archer shareIcon">&#xe71d;</span>
                        <span class="shareText">Share</span>
                        <ul class="shareList">
                            <li class="iconfont-archer share-qr" data-type="qr">&#xe75b;
                                <div class="share-qrcode"></div>
                            </li>
                            <li class="iconfont-archer" data-type="weibo">&#xe619;</li>
                            <li class="iconfont-archer" data-type="qzone">&#xe62e;</li>
                            <li class="iconfont-archer" data-type="twitter">&#xe634;</li>
                            <li class="iconfont-archer" data-type="facebook">&#xe67a;</li>
                        </ul>
                    </span>
                </div>
            </div>
        
    </div>
</div>
        <script>
 
  // get user agent
  var browser = {
    versions: function () {
      var u = window.navigator.userAgent;
      return {
        userAgent: u,
        trident: u.indexOf('Trident') > -1, //IE内核
        presto: u.indexOf('Presto') > -1, //opera内核
        webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
        gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
        mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
        ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
        android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或者uc浏览器
        iPhone: u.indexOf('iPhone') > -1 || u.indexOf('Mac') > -1, //是否为iPhone或者安卓QQ浏览器
        iPad: u.indexOf('iPad') > -1, //是否为iPad
        webApp: u.indexOf('Safari') == -1, //是否为web应用程序，没有头部与底部
        weixin: u.indexOf('MicroMessenger') == -1, //是否为微信浏览器
        uc: u.indexOf('UCBrowser') > -1 //是否为android下的UC浏览器
      };
    }()
  }
  console.log("userAgent:" + browser.versions.userAgent);

  // callback
  function fontLoaded() {
    console.log('font loaded');
    if (document.getElementsByClassName('site-intro-meta')) {
      document.getElementsByClassName('intro-title')[0].classList.add('intro-fade-in');
      document.getElementsByClassName('intro-subtitle')[0].classList.add('intro-fade-in');
      var postIntros = document.getElementsByClassName('post-intros')[0]
      if (postIntros) {
        postIntros.classList.add('post-fade-in');
      }
    }
  }

  // UC不支持跨域，所以直接显示
  function asyncCb(){
    if (browser.versions.uc) {
      console.log("UCBrowser");
      fontLoaded();
    } else {
      WebFont.load({
        custom: {
          families: ['Oswald-Regular']
        },
        loading: function () {  //所有字体开始加载
          // console.log('loading');
        },
        active: function () {  //所有字体已渲染
          fontLoaded();
        },
        inactive: function () { //字体预加载失败，无效字体或浏览器不支持加载
          console.log('inactive: timeout');
          fontLoaded();
        },
        timeout: 5000 // Set the timeout to two seconds
      });
    }
  }

  function asyncErr(){
    console.warn('script load from CDN failed, will load local script')
  }

  // load webfont-loader async, and add callback function
  function async(u, cb, err) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (cb) { o.addEventListener('load', function (e) { cb(null, e); }, false); }
    if (err) { o.addEventListener('error', function (e) { err(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }

  var asyncLoadWithFallBack = function(arr, success, reject) {
      var currReject = function(){
        reject()
        arr.shift()
        if(arr.length)
          async(arr[0], success, currReject)
        }

      async(arr[0], success, currReject)
  }

  asyncLoadWithFallBack([
    "https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js", 
    "https://cdn.bootcss.com/webfont/1.6.28/webfontloader.js",
    "/lib/webfontloader.min.js"
  ], asyncCb, asyncErr)
</script>        
        <img class="loading" src="/assets/loading.svg" style="display: block; margin: 6rem auto 0 auto; width: 6rem; height: 6rem;" />
        <div class="container container-unloaded">
            <main class="main post-page">
    <article class="article-entry">
        <p>前言：内容大幅度参考了网上一些博客 + 亲自实践。若文末忘记注明出处，请见谅，留言修改。</p>
<h1 id="一、为什么制作马甲？"><a href="#一、为什么制作马甲？" class="headerlink" title="一、为什么制作马甲？"></a>一、为什么制作马甲？</h1><ul>
<li><p>防止app因为违规被苹果下架后”一无所有”。付费视频类，彩票类的app多少都会违反苹果的一些规范有被下架的风险，马甲包可以在app被下架的时候顶上去，那什么情况下会被下架呢？</p>
<ul>
<li>之前审核的时候用到开关，审核过了之后APP的内容和审核时的内容差异较大，苹果复查的时候发现被下架</li>
<li>用户举报，被下架</li>
<li>竞品方举报，被下架</li>
</ul>
</li>
<li><p>为主app导入流量，因为马甲包一般和主app用的是同一套后台，用户数据上是互通的，可以通过在马甲包里添加跳转链接等方式引导用户去下载使用主app，往主app里导入流量</p>
</li>
<li><p>广撒网，增加收入。</p>
</li>
</ul>
<p>之前做过付费视频APP，其实那个时候付费视频的黄金期已经快过了，上架的第一个APP通过做aso优化，一天的用户充值可以达到15000左右，但是再想提高充值就很难了(针对我们当时APP的情况)。但是再上架一个功能一样马甲包，通过aso优化很轻松就能做到日充值10000左右，可以脑洞大开一下如果上架100个马甲包会是一种怎样的体验。其实一般的小公司能做上架七八个就很够用了，日流水近10万，很可观了</p>
<p>其实苹果2018年5月份之前对马甲包的审核力度还不是很大，但是七月份之后苹果对马甲包的审核处理力度增大了很多。是因为在这期间世界杯的到来，很多博彩类的app马甲包上架，这种情况也被央视报道，说苹果审核不够严谨，应用市场上充斥着大量的马甲包，导致应用市场混乱，引起了苹果的重视，大量下架了这类app，理所应当马甲包的上架审核也严格了很多。</p>
<p>在这之后马甲包上架就更加困难了，苹果对代码层面的审核也严格了很多，所以马甲包的代码混淆就要比之前力度更大，包括资源文件，费代码，混淆都要尽量多的添加和修改。马甲包的功能也要尽可能的完善丰富起来(功能单一容易被2.1大礼包)，而且这些功能不能太大众化，同类产品也很用可能用类似的马甲。</p>
<h1 id="二、解决两个问题"><a href="#二、解决两个问题" class="headerlink" title="二、解决两个问题"></a>二、解决两个问题</h1><ul>
<li><p>2.1 : 说是违反了一个或多个应用市场规则，一旦跟马甲包、棋牌、彩票等扯上关系(比如关键词含有赌博、竞彩等)，都将会上标记，进入机审流程，最后以2.1理由批量拒绝。</p>
</li>
<li><p>4.3 : 应用程序提供了与提交给App Store的其他应用程序相同的特性集；它只是内容或语言不同，这被认为是垃圾邮件的一种形式</p>
</li>
</ul>
<h2 id="2-1-脚本混淆"><a href="#2-1-脚本混淆" class="headerlink" title="2.1 脚本混淆"></a>2.1 脚本混淆</h2><p>混淆 <a target="_blank" rel="noopener" href="https://baijiahao.baidu.com/s?id=1614026762321155428&wfr=spider&for=pc">脚本混淆</a>、<a target="_blank" rel="noopener" href="https://blog.csdn.net/yiyaaixuexi/article/details/29201699">念茜-OC代码混淆</a></p>
<p>注意：添加混淆作用的头文件（这个文件名是脚本confuse.sh中定义的） </p>
<p><code>#import &quot;codeObfuscation.h&quot;</code> 需要自己手动addFileTo…</p>
<p><strong>被拒，苹果新规：不允许使用这种脚本混淆了。违反了2.3.1，说有隐藏功能，base64加密API肯定不能再使用了，苹果都说了，加密特征太过明显。</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">### Guideline 2.3.1 - Performance</span><br><span class="line"></span><br><span class="line">We discovered that your app contains hidden features. Specifically, it would be appropriate to remove all code obfuscation and selector mangling or to explain in detail the purpose of its inclusion before resubmitting for review.</span><br><span class="line">The next submission of this app may require a longer review time, and this app will not be eligible for an expedited review until this issue is resolved.</span><br><span class="line"></span><br><span class="line">**Next Steps**</span><br><span class="line">- Review the Performance section of the [App Store Review Guidelines](https://developer.apple.com/app-store/review/guidelines/).</span><br><span class="line">- Ensure your app is compliant with all sections of the [App Store Review Guidelines](https://developer.apple.com/app-store/review/guidelines/) and the [Terms &amp; Conditions](https://developer.apple.com/terms/) of the Apple Developer Program. </span><br><span class="line">- Once your app is fully compliant, resubmit your app for review.</span><br><span class="line"></span><br><span class="line">Submitting apps designed to mislead or harm customers or evade the review process may result in the termination of your Apple Developer Program account. Review the [Terms &amp; Conditions](https://developer.apple.com/terms/) of the Apple Developer Program to learn more about our policies regarding termination.</span><br><span class="line"></span><br><span class="line">询问为什么说我们有隐藏功能的苹果回复：</span><br><span class="line">Thank you for the response. Your app includes code obfuscation and selector mangling (ConfuseCode, it would be appropriate to remove all code obfuscation and selector mangling (ConfuseCode) or to explain in detail the purpose of its inclusion before resubmitting for review.</span><br></pre></td></tr></table></figure>

<h2 id="2-2-手动混淆"><a href="#2-2-手动混淆" class="headerlink" title="2.2 手动混淆"></a>2.2 手动混淆</h2><h3 id="2-2-1-思路"><a href="#2-2-1-思路" class="headerlink" title="2.2.1 思路"></a>2.2.1 思路</h3><p>切断当前马甲包与以往马甲包的所有相似性关联；</p>
<p>包括分项细述：</p>
<ul>
<li><p>ipa包特征。包括有</p>
<ul>
<li>代码相似性：<ul>
<li>已有代码的混淆<ul>
<li>改项目名：参考链接：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/ljmaque/p/rename.html">iOS 最新修改项目名称</a></li>
<li>改文件、类、函数、宏、全局变量名</li>
<li>新增属性、属性使用，函数以及函数调用</li>
<li>改项目配置、plist文件等</li>
</ul>
</li>
<li>添加一些无用的代码， 切记一定要调用， 这是重点; </li>
<li>删注释是没用的，因为注释是不会被编译进包里</li>
<li>改文件夹或者文件名应该是不太靠谱的，编译的时候会根据路径来引用查找，编译之后应该是根据在包里的相对内存地址来查找类和函数，跟你编译时的文件名称和路径关系应该不大。不过为了方便和代码的统一，更换时可以顺便换了。</li>
</ul>
</li>
<li>资源相似性：<ul>
<li>资源改名如图片、音效；</li>
<li>适当添加一些无用的资源</li>
</ul>
</li>
</ul>
</li>
<li><p>开发者帐号：两个马甲包不要关联到同一个开发者帐号的信息；比如打包时关联。</p>
</li>
<li><p>打包电脑：有条件的最好用不同的MAC来打包（每台MAC上最好打包马甲包不要超过5个）</p>
</li>
<li><p>上传IP：上传马甲包时，IP不要跟其他马甲包的IP相同</p>
</li>
<li><p>材料相似：</p>
<ul>
<li>ituns后台材料如宣传图，icon，版权人不要出现相同；</li>
<li>应用内部UI最好也做调整，规避人工4.3问题。</li>
</ul>
</li>
</ul>
<p>修改名称时，不要生成随机的md5编码数据格式串的名字，不管是代码还是图片资源，会被苹果认定在刻意隐藏一些功能。</p>
<h3 id="2-2-2-KLGenerateSpamCode"><a href="#2-2-2-KLGenerateSpamCode" class="headerlink" title="2.2.2 KLGenerateSpamCode"></a>2.2.2 KLGenerateSpamCode</h3><p><a target="_blank" rel="noopener" href="https://github.com/klaus01/KLGenerateSpamCode">KLGenerateSpamCode</a> 是一个应对苹果对重复应用的审核（Guideline 4.3 Design Spam）的工具，用于避免苹果机审检测概率。</p>
<p>主要功能有：</p>
<ul>
<li>  修改工程名</li>
<li>  修改类名前缀</li>
<li>  扫描工程中的代码，生成同等数量的 Category 文件，文件中及是同等方法数量的垃圾代码。</li>
<li>  修改 xxx.xcassets 文件夹中的 png 资源文件名。</li>
<li>  删除代码中的所有注释和空行(这个貌似没什么必要)。</li>
</ul>
<h1 id="三、审核流程"><a href="#三、审核流程" class="headerlink" title="三、审核流程"></a>三、审核流程</h1><h2 id="3-1-机审"><a href="#3-1-机审" class="headerlink" title="3.1 机审"></a>3.1 机审</h2><ol>
<li> APP工程重命名 </li>
<li> 文件夹名、文件名重命名：类前缀  </li>
<li> API（方法名、属性）：方法名前缀  </li>
<li> 添加大量的垃圾文件（<strong>只添加，不引用好像也不行，可以创建一些view/model 不添加显示</strong>）</li>
<li> 往之前的代码中添加废代码，进行混淆(记住添加注释是没有用的，)</li>
<li> 资源文件的属性进行修改，就是md5编码与之前的资源文件不同(其实很简单，让ui把素材放入ps中再重新导出就可以了)  </li>
</ol>
<p>由此可见：+类前缀、方法名前缀是有多重要…</p>
<h2 id="3-2-人审"><a href="#3-2-人审" class="headerlink" title="3.2 人审"></a>3.2 人审</h2><ul>
<li>UI界面尽量跟之前有大的区别(这里可以做开关)</li>
<li>修改截图，icon，logo，ui，ue，url，界面风格，配色</li>
<li>马甲包功能不能太简单容易被苹果送上2.1大礼包</li>
</ul>
<p>说起来简单：就是代码尽量多的混淆，跟之前包的代码有大的区别。马甲包内容尽量与众不同，功能尽量完善</p>
<p>做起来难：做一个完美的马甲包其实跟做了一个新的App差不多了</p>
<h2 id="3-3-审核被拒处理"><a href="#3-3-审核被拒处理" class="headerlink" title="3.3 审核被拒处理"></a>3.3 审核被拒处理</h2><p><strong>第一种机器审核（主要是App代码上、App相关资料方面）</strong></p>
<p>被拒信息一般都是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Guideline4.3 - Design - Spam（找技术改代码）</span><br><span class="line"></span><br><span class="line">Your app duplicates the content and functionality of apps submitted to the AppStore, which is considered a form of spam.</span><br></pre></td></tr></table></figure>

<p>这种主要是对App进行扫描，就和我们毕业论文查重一样，针对关键性信息进行匹配，当这个匹配度超过一定的比例，苹果就会认为重复应用。</p>
<p>在代码层级上来查，现在苹果应该是已经达到全面扫描二进制文件，从中提取技术特征，有种查杀病毒的赶脚。比较明显的就是现在游戏App如果接入了某宝或者某信的支付SDK，那么这种包体必定会被拒，这就是苹果预先对一些带有第三方支付的sdk采集技术特征，然后机器扫描你是否接入了这个SDK。</p>
<p>如果是资料的话，无非是苹果的两个开发者后台(<a target="_blank" rel="noopener" href="http://developer.apple.com/%E5%92%8Chttp://itunesconnect.apple.com/)%E4%B8%8A%E7%9A%84%E4%BF%A1%E6%81%AF%EF%BC%8C%E8%BF%99%E7%A7%8D%E5%92%8C%E4%BB%A3%E7%A0%81%E5%B1%82%E4%B8%8A%E6%8E%92%E9%87%8D%E5%B7%AE%E4%B8%8D%E5%A4%9A%EF%BC%8C%E5%90%8C%E6%A0%B7%E6%98%AF%E6%8F%90%E5%8F%96%E7%89%B9%E5%BE%81%E5%80%BC%E3%80%82">http://developer.apple.com/和http://itunesconnect.apple.com/)上的信息，这种和代码层上排重差不多，同样是提取特征值。</a></p>
<p>具体是上面那种原因被拒，根据我上包的经验来看，如果是从提交审核到拒审的时间间隔较短，那么很大可能就是资料上的重复导致。这种情况下，我们需要对我们的资料进行排查了。如果间隔时间较长，那么这种就一定是代码的问题，我们就需要在对代码进行混淆、垃圾代码等操作，反正必须改变特征比例。</p>
<p><strong>第二种人工审核（对APP的内容、功能进行核验，防止APP有bug，防止APP模仿其他应用，内容与其他APP重复）</strong></p>
<p>被拒信息一般都是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Guideline4.3 - Design - Spam （改UI）</span><br><span class="line"></span><br><span class="line">Wefound that your app provides the same feature set as other apps submitted to the App Store, which is not appropriate to the App Store.</span><br></pre></td></tr></table></figure>

<p>这种在我看来，就是界面、功能、app名称等，和其他的App太相似了，审核人员一看就觉得是个马甲包；另外一种就是审核人员可能只是怀疑，这种我们就稍微进行假页面的添加、修改下前期的UI界面，如果这种还被审核人员查到了，就需要申诉，说明我们不一样。</p>
<p><strong>第三种 名字等相似度过高</strong></p>
<p>名字相似度太高，很多产品或运营同学经常是这个账号被拒太多次之后，就转移到另一个账号去上，同时又没有将原来账号里的APP作废，这样就导致4.3问题的出现。要记得，如果是要重新在其他账号上架，一定要关注名字、icon以及代码的问题。</p>
<p>关于审核时间**:**</p>
<ul>
<li>只要出现4.3或2.1 全都出现了审核延迟，大概7-10天左右再会审核的。所以花了这么长时间，而创建了新的应用，就不会延时。基本上当天晚上就会审(周未除外)</li>
</ul>
<p>关于应用相似度</p>
<ul>
<li>应用全是做电商类的，原生代码都是封装了第三方的，也都一样，因为是外包公司，底层都一样，一个框架开发出来的。前端UI及JS方面。50%差不多，每款应用都有进行了修改，一般改动的是30%-50%。</li>
</ul>
<p>其它说明</p>
<ul>
<li>我们的应用也不属于马甲包吧，外包公司，制定了一套模块或是封装了一些代码，拿来重用，界面部分都是定制的。苹果要死认定是我是重复应用，我这也是百口莫辨，无奈只有不断提交上次，不断尝试。 实在上架不了，技术也要另寻高就了。为了糊口也没有办法。</li>
</ul>
<p><strong>结论</strong>: </p>
<p>旧应用进行更新上架，两次是100%一晚通过，  新应用，只要当前账户有被拒了4.3 再创建了新的，也会被拒4.3。比较危险的情况是：一个开发者账号下，存在过一直因为4.3的原因审核被拒，再在这个账号上提交马甲包，很容易被推迟审核或则再次因为4.3被拒，最好放弃这个账号，采用新账号去提交审核。</p>
<h1 id="四、App配置多个马甲包的环境"><a href="#四、App配置多个马甲包的环境" class="headerlink" title="四、App配置多个马甲包的环境"></a>四、App配置多个马甲包的环境</h1><p>在一个工程中，动态配置马甲包的bundle id、appicon、lanuchImage等<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/04b63de8ae23">：iOS app配置多环境变量和制作马甲包</a></p>
<h1 id="附一篇实操文章"><a href="#附一篇实操文章" class="headerlink" title="附一篇实操文章"></a>附一篇实操文章</h1><ul>
<li><a target="_blank" rel="noopener" href="https://www.vincents.cn/2018/10/24/ios-hikari/">iOS 马甲包、代码混淆、编译混淆实践</a></li>
<li><a target="_blank" rel="noopener" href="https://www.niaogebiji.com/article-17212-1.html">“苹果2.1大礼包”审核被拒，这有份iOS马甲包混淆方案</a></li>
</ul>
<blockquote>
<p>功能已经过时，但思路挺全面的</p>
</blockquote>
<h2 id="1-马甲包"><a href="#1-马甲包" class="headerlink" title="1. 马甲包"></a>1. 马甲包</h2><h3 id="1-1-什么是马甲包"><a href="#1-1-什么是马甲包" class="headerlink" title="1.1 什么是马甲包?"></a>1.1 什么是马甲包?</h3><p>马甲包是利用 App store 的规则漏洞，通过技术手段，多次上架同一款产品的方法。马甲包和主产品包拥有基本一致的内容和功能，项目代码基本都是完全复用的，除了图标，应用名称，包名等不一致，其他基本一致。</p>
<h3 id="1-2-为什么做马甲包，以及马甲包的好处"><a href="#1-2-为什么做马甲包，以及马甲包的好处" class="headerlink" title="1.2 为什么做马甲包，以及马甲包的好处"></a>1.2 为什么做马甲包，以及马甲包的好处</h3><ul>
<li><p><strong>AB 测试</strong><br>可以测试跨度大的新功能，好的功能就在主包上迭代，不好的也无所谓，不影响主包的使用体验，避免用户流失。</p>
</li>
<li><p><strong>导流</strong><br>主包和马甲包同属一个平台，用户信息可以共享；通过弹窗,广告,Push等引导用户到App Store下载主App；有一部份App接了网盟相互导流。</p>
</li>
<li><p><strong>增加关键词覆盖</strong><br>App Store关键词长度上限是100个字符,据了解人为正常优化的极限是关键词覆盖数在4000左右,那些覆盖数在8000+的都是利用了苹果漏洞。所以,多做一个马甲,也就意味着覆盖的关键词可以更多。</p>
</li>
<li><p><strong>刷榜</strong><br>积分墙、真机、机刷等。用马甲包来刷排名，抵抗主包风险。</p>
</li>
</ul>
<h3 id="1-3-马甲包制作注意事项"><a href="#1-3-马甲包制作注意事项" class="headerlink" title="1.3 马甲包制作注意事项"></a>1.3 马甲包制作注意事项</h3><ul>
<li><p><strong>二进制不同</strong><br>应用名称，图标，包名，工程名，打包电脑，代码，静态资源等的修改。</p>
</li>
<li><p><strong>差异化</strong><br>整体UI，产品功能，页面布局等的修改</p>
</li>
</ul>
<h3 id="1-4-实践"><a href="#1-4-实践" class="headerlink" title="1.4 实践"></a>1.4 实践</h3><p><a target="_blank" rel="noopener" href="https://github.com/klaus01/KLGenerateSpamCode">KLGenerateSpamCode</a> 是一个应对苹果对重复应用的审核（Guideline 4.3 Design Spam）的工具，用于避免苹果机审检测概率。</p>
<p>主要功能有：</p>
<ul>
<li>修改工程名</li>
<li>修改类名前缀</li>
<li>扫描工程中的代码，生成同等数量的 Category 文件，文件中及是同等方法数量的垃圾代码。</li>
<li>修改 xxx.xcassets 文件夹中的 png 资源文件名。</li>
<li>删除代码中的所有注释和空行。</li>
</ul>
<img src="/images/ios/vest/15402030163246.jpg" alt="-w910" style="zoom:67%;" />

<p>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># 1. 项目名地址，注意不是项目文件夹地址</span><br><span class="line">/Users/vincent/Desktop/code/spamCode/VHLSpamCodeDemo/VHLSpamCodeDemo   </span><br><span class="line"># 2. 修改项目名称</span><br><span class="line">-modifyProjectName VHLSpamCodeDemo&gt;VHLSpamCodeDemo1</span><br><span class="line"># 3. 忽略文件夹</span><br><span class="line">-ignoreDirNames Depends</span><br><span class="line"># 4. 修改类名前缀。没有前缀的会加上前缀，有前缀的会修改。注意修改后是否重名</span><br><span class="line">-modifyClassNamePrefix /Users/vincent/Desktop/code/spamCode/VHLSpamCodeDemo/VHLSpamCodeDemo.xcodeproj VHL&gt;VIN</span><br><span class="line"># 5. 生成垃圾代码</span><br><span class="line">-spamCodeOut /Users/vincent/Desktop/code/spamCode/VHLSpamCodeDemo/VHLSpamCodeDemo2/SpamCode VSpam</span><br><span class="line"># 6. 修改 xxx.xcassets 文件夹中的 png 资源文件名</span><br><span class="line">-handleXcassets</span><br><span class="line"># 7. 删除空行和注释 </span><br><span class="line">-deleteComments</span><br></pre></td></tr></table></figure>

<img src="/images/ios/vest/15402873574819.jpg" alt="-w1075" style="zoom:57%;" />


<p>修改工程名后，如果包含 pod，需要到文件夹下重新执行 <code>pod update</code></p>
<h3 id="1-5-优化图片大小，修改图片-hash-值"><a href="#1-5-优化图片大小，修改图片-hash-值" class="headerlink" title="1.5 优化图片大小，修改图片 hash 值"></a>1.5 优化图片大小，修改图片 hash 值</h3><ul>
<li><p><a target="_blank" rel="noopener" href="https://imageoptim.com/mac">ImageOptim</a> </p>
<p>mac 下无损压缩图片工具，将包含图片的文件夹拖入工具，会自动扫描文件夹下的所有文件，自动选择最优算法进行优化。一般第一次优化项目时，会有几M到10几M的优化效果。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="http://www.imagemagick.org/script/index.php">ImageMagick</a></p>
<p>ImageMagick: 是一款创建、编辑、合成，转换图像的命令行工具。</p>
<p>通过 <code>brew</code> 安装 <code>imagemagick</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install imagemagick</span><br></pre></td></tr></table></figure>

<p>压缩文件夹下所有 png 文件，会修改 hash 值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find . -iname &quot;*.png&quot; -exec echo &#123;&#125; \; -exec convert &#123;&#125; &#123;&#125; \;</span><br></pre></td></tr></table></figure>

<p>更多 <code>imagemagick</code> 命令以及使用方法<br><a target="_blank" rel="noopener" href="https://aotu.io/notes/2018/06/06/ImageMagick_intro/index.html">图像处理 - ImageMagick 简单介绍与案例</a></p>
</li>
</ul>
<h2 id="2-逆向基础，以及为什么要做混淆"><a href="#2-逆向基础，以及为什么要做混淆" class="headerlink" title="2. 逆向基础，以及为什么要做混淆"></a>2. 逆向基础，以及为什么要做混淆</h2><p>当我们用 Xcode 构建一个程序的过程时，编译器会把源文件 (.m 和 .h) 文件转换为一个可执行文件。这个可执行文件中包含的字节码会将被 CPU 执行，虽然不能直接从这些字节码中查看我们的核心代码，但是黑客可以通过一些反汇编的逆向工具来分析我们的程序，找到漏洞进行破解。</p>
<blockquote>
<p>可执行文件格式</p>
</blockquote>
<p><strong>EXE</strong>     <code>Windows</code> 下可直接执行的文件扩展名<br><strong>ELF</strong>     <code>Linux</code> 下的可执行文件<br><strong>Mach-O</strong>  <code>MacOS/iOS</code> 下主要的可执行文件</p>
<h3 id="2-1-Mach-与-Mach-O"><a href="#2-1-Mach-与-Mach-O" class="headerlink" title="2.1 Mach 与 Mach-O"></a>2.1 Mach 与 Mach-O</h3><p>Mac 是苹果电脑 Macintosh 的简称，而 Mach 则是一种操作系统内核。Mach 内核被 NeXT 公司的NeXTSTEP 操作系统使用。在Mach上，一种可执行的文件格是就是 Mach-O（Mach Object file format）。1996年，乔布斯将 NeXTSTEP 带回苹果，成为了OS X的内核基础。所以虽然 MacOS X 是 Unix 的“后代”，但所主要支持的可执行文件格式是 Mach-O。</p>
<h3 id="2-2-iOS-可执行文件"><a href="#2-2-iOS-可执行文件" class="headerlink" title="2.2 iOS 可执行文件"></a>2.2 iOS 可执行文件</h3><p>通常我们通过 Xcode 打包或者从应用商店下载的 APP 都是 <code>ipa</code> 包（iPhone Application）。这是一个变相的 zip 压缩包，可以通过 <code>unzip</code> 命令进行解压。</p>
<p>解压之后，会有一个 Payload 目录，而 Payload 里则是一个 <strong>.app</strong> 文件，而这个实际上又是一个目录，或者说是一个完整的 App Bundle。</p>
<p>在这个目录中，里面体积最大的文件通常就是和 ipa 包同名的一个二进制文件。通过 <code>file</code> 命令可以查看该文件的类型</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xx: Mach-O universal binary with 2 architectures: [arm_v7:Mach-O executable arm_v7] [arm64]</span><br><span class="line">xx (for architecture armv7):	Mach-O executable arm_v7</span><br><span class="line">xx (for architecture arm64):	Mach-O 64-bit executable arm64</span><br></pre></td></tr></table></figure>

<p>这里可以看出，这是一个支持 armv7 和 armv7s 两种处理器架构的通用程序包，里面包含的两部分都是 Mach-O 格式。</p>
<blockquote>
<p><strong>i386</strong> 模拟器32位处理器<br><strong>x86_64</strong> 模拟器64位处理器<br><strong>armv7,armv7s</strong> 真机32位处理器<br><strong>arm64</strong> 真机64位处理器</p>
</blockquote>
<p>Mach-O 的文件结构：</p>
<p><img src="/images/ios/vest/15402721412482.gif"></p>
<p>从这张图上来看，Mach-O文件的数据主体可分为三大部分，分别是头部（Header）、加载命令（Load commands）、和最终的数据（Data）。</p>
<h3 id="2-3-class-dump"><a href="#2-3-class-dump" class="headerlink" title="2.3 class-dump"></a>2.3 class-dump</h3><p><a target="_blank" rel="noopener" href="http://stevenygard.com/projects/class-dump/">class-dump</a> 是一个利用 Objective-C 语言的 runtime 特性，将存储在 Mach-O 文件结构里 data 部分的类属性和方法等信息提取出来，并生成对应的 .h 文件的工具。<strong>注意: 必须是脱壳后的可执行文件。(比如通过越狱手机或者第三方应用下载渠道)</strong></p>
<h3 id="2-4-安装使用"><a href="#2-4-安装使用" class="headerlink" title="2.4 安装使用"></a>2.4 安装使用</h3><p>在 <a target="_blank" rel="noopener" href="http://stevenygard.com/projects/class-dump/">class-dump</a> 官网下载 dmg，将 dmg 里面的 <code>class-dump</code> 拷贝到 <code>/usr/local/bin</code> 文件夹下，然后就可以在终端中使用 <code>class-dump</code> 命令了。</p>
<p>简单使用：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">class-dump -H [需要被导出的 Mach-O 文件路径] -o [头文件输出目录地址]</span><br></pre></td></tr></table></figure>

<p>也可以可以查看导出后的头文件目录：</p>
<img src="/images/ios/vest/15402749967715.jpg" alt="-w621" style="zoom:61%;" />

<h3 id="2-5-hopper"><a href="#2-5-hopper" class="headerlink" title="2.5 hopper"></a>2.5 hopper</h3><p><a target="_blank" rel="noopener" href="https://www.hopperapp.com/">Hopper</a> 是一种适用于 OS X 和 Linux 的逆向工程工具，可以用于反汇编、反编译和调试 32位/64位英特尔处理器的 Mac、Linux、Windows 和 iOS 可执行程序。</p>
<p>将 Mach-O 文件拖入 <a target="_blank" rel="noopener" href="https://www.hopperapp.com/">hopper</a> 可以查看。</p>
<img src="/images/ios/vest/15402820640765.jpg" alt="-w1425" style="zoom:51%;" />


<p>通过以上的方式，别人可以对照应用的功能来分析代码逻辑，从而进行针对性的破解。所以对项目的核心的代码进行混淆就是非常有必要的了。</p>
<h2 id="3-代码混淆"><a href="#3-代码混淆" class="headerlink" title="3. 代码混淆"></a>3. 代码混淆</h2><p>常规的混淆思路：</p>
<ul>
<li>花代码花指令，即随意往程序中加入迷惑人的代码指令</li>
<li>易读字符替换</li>
</ul>
<p>防止被 class-dump 后，被人分析核心代码逻辑。可以对关键，已读的字符串进行替换，比如 <code>ad</code>, <code>vip</code> 等关键词。</p>
<h3 id="3-1-替换字符串混淆"><a href="#3-1-替换字符串混淆" class="headerlink" title="3.1 替换字符串混淆"></a>3.1 替换字符串混淆</h3><p>但是我们又不想替换成不想关的字符串后给自己调试带来麻烦，这里我们可以使用 <a target="_blank" rel="noopener" href="https://github.com/housenkui/HSKConfuse">HSKConfuse</a> 的 shell 脚本，通过在Build Phrase 中设定在编译之前进行方法名的字符串替换，从而在不影响自己编写代码的基础上，对编译后的二进制包进行混淆。</p>
<p>首先在项目中新建文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">confuse.sh： 存放混淆的脚本</span><br><span class="line">func.list： 需要混淆的方法、变量名</span><br></pre></td></tr></table></figure>

<p><strong>confuse.sh</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env bash</span><br><span class="line"></span><br><span class="line">TABLENAME=symbols</span><br><span class="line">SYMBOL_DB_FILE=&quot;symbols&quot;</span><br><span class="line">STRING_SYMBOL_FILE=&quot;$PROJECT_DIR/VHLObfuscationDemo/VHLObfuscation/func.list&quot;</span><br><span class="line"></span><br><span class="line">CONFUSE_FILE=&quot;$PROJECT_DIR/VHLObfuscationDemo&quot;</span><br><span class="line">HEAD_FILE=&quot;$PROJECT_DIR/VHLObfuscationDemo/VHLObfuscation/codeObfuscation.h&quot;</span><br><span class="line"></span><br><span class="line">export LC_CTYPE=C</span><br><span class="line"></span><br><span class="line"># ** 可以不执行下面的方法，替换成自己的规则手动写入到 func.list 中**</span><br><span class="line"># 取以.m或.h结尾的文件以+号或-号开头的行，并以 vhl_ 开头的方法 |去掉所有+号或－号|用空格代替符号|n个空格跟着&lt;号 替换成 &lt;号|开头不能是IBAction|用空格split字串取第二部分|排序|去重复|删除空行|删掉以init开头的行&gt;写进func.list</span><br><span class="line">grep -h -r -I  &quot;^[-+]&quot; $CONFUSE_FILE  --include &#x27;*.[mh]&#x27; |sed &quot;s/[+-]//g&quot;|sed &quot;s/[();,: *\^\/\&#123;]/ /g&quot;|sed &quot;s/[ ]*&lt;/&lt;/&quot;| sed &quot;/^[ ]*IBAction/d&quot;|awk &#x27;&#123;split($0,b,&quot; &quot;); print b[2]; &#125;&#x27;| sort|uniq |sed &quot;/^$/d&quot;|sed -n &quot;/^vhl_/p&quot; &gt;$STRING_SYMBOL_FILE</span><br><span class="line"></span><br><span class="line">#维护数据库方便日后作排重,以下代码来自念茜的微博</span><br><span class="line">createTable()</span><br><span class="line">&#123;</span><br><span class="line">echo &quot;create table $TABLENAME(src text, des text);&quot; | sqlite3 $SYMBOL_DB_FILE</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">insertValue()</span><br><span class="line">&#123;</span><br><span class="line">echo &quot;insert into $TABLENAME values(&#x27;$1&#x27; ,&#x27;$2&#x27;);&quot; | sqlite3 $SYMBOL_DB_FILE</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">query()</span><br><span class="line">&#123;</span><br><span class="line">echo &quot;select * from $TABLENAME where src=&#x27;$1&#x27;;&quot; | sqlite3 $SYMBOL_DB_FILE</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ramdomString()</span><br><span class="line">&#123;</span><br><span class="line">openssl rand -base64 64 | tr -cd &#x27;a-zA-Z&#x27; |head -c 16</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">rm -f $SYMBOL_DB_FILE</span><br><span class="line">rm -f $HEAD_FILE</span><br><span class="line">createTable</span><br><span class="line"></span><br><span class="line">touch $HEAD_FILE</span><br><span class="line">echo &#x27;#ifndef Demo_codeObfuscation_h</span><br><span class="line">#define Demo_codeObfuscation_h&#x27; &gt;&gt; $HEAD_FILE</span><br><span class="line">echo &quot;//confuse string at `date`&quot; &gt;&gt; $HEAD_FILE</span><br><span class="line">cat &quot;$STRING_SYMBOL_FILE&quot; | while read -ra line; do</span><br><span class="line">if [[ ! -z &quot;$line&quot; ]]; then</span><br><span class="line">ramdom=`ramdomString`</span><br><span class="line">echo $line $ramdom</span><br><span class="line">insertValue $line $ramdom</span><br><span class="line">echo &quot;#define $line $ramdom&quot; &gt;&gt; $HEAD_FILE</span><br><span class="line">fi</span><br><span class="line">done</span><br><span class="line">echo &quot;#endif&quot; &gt;&gt; $HEAD_FILE</span><br><span class="line"></span><br><span class="line">sqlite3 $SYMBOL_DB_FILE .dump</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>以上的 shell 脚本运行后会自动获取 <code>.h</code>, <code>m</code> 文件中以 <code>vhl_</code> 开头的方法写到到该文件。如果需要自定义的话，可以不执行以上那句命令，然后换成自己的规则写入 <strong>func.list</strong> 中。例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vhl_isVIP</span><br><span class="line">xx_showAD</span><br><span class="line">yy_isAllow</span><br></pre></td></tr></table></figure>

<p>然后在 <code>Build Phases</code> 中，左上角加号添加 <code>run script</code> 填入地址</p>
<img src="/images/ios/vest/15402815261872.jpg" alt="-w1125" style="zoom:57%;" />

<h3 id="3-2-查看编译结果"><a href="#3-2-查看编译结果" class="headerlink" title="3.2 查看编译结果"></a>3.2 查看编译结果</h3><img src="/images/ios/vest/15403674704990.jpg" alt="-w899" style="zoom:64%;" />

<p>成功编译后，会在指定目录下生成一个 <code>codeObfuscation.h</code> 文件。这里可以看到，在编译过程中会执行 shell 脚本，对相关字符串进行替换</p>
<p>添加 <code>.pch</code> 文件，并在 <code>Build Setttings</code> &gt; <code>Prefix Header</code> 中链接该 <code>.pch</code> 文件，在 <code>.pch</code> 文件中导入 <code>codeObfuscation.h</code>，此时项目中指定的方法都被替换成了<code>codeObfuscation.h</code> 中的宏定义。</p>
<img src="/images/ios/vest/15402867506913.jpg" alt="-w906" style="zoom:64%;" />


<p>运行成功后将 Products 中的二进制文件拖入到 hopper 中查看</p>
<img src="/images/ios/vest/15402864436528.jpg" alt="-w1008" style="zoom:61%;" />

<p>此时，方法已经被混淆了。</p>
<p><strong>注意：这个不要大面积的使用，会有被审核拒绝的风险，拒绝原因是说你程序里面可能包含有隐藏功能，因为 apple 无法从这些混淆后的方法获取到有用的信息。</strong></p>
<h2 id="4-编译混淆"><a href="#4-编译混淆" class="headerlink" title="4. 编译混淆"></a>4. 编译混淆</h2><p>以上我们虽然对关键字符串进行了混淆，但是实际代码的执行逻辑等并没有改变。黑客仍然可以通过分析代码逻辑或者伪代码来寻找程序的漏洞。那有没有可能改变编译后的代码逻辑，从而让别人无法分析我们的程序呢。</p>
<h3 id="4-1-iOS-是如何编译的"><a href="#4-1-iOS-是如何编译的" class="headerlink" title="4.1 iOS 是如何编译的"></a>4.1 iOS 是如何编译的</h3><p>Objective C采用 <strong>Clang</strong> 作为前端，而 Swift 则采用 <strong>swift()</strong> 作为前端，二者都是用 <strong>LLVM(Low level vritual machine)</strong> 作为编译器后端。</p>
<p>编译命令地址</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Objective-C</span><br><span class="line">/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang</span><br><span class="line"># Swift</span><br><span class="line">/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/swift</span><br></pre></td></tr></table></figure>

<p>Xcode 编译过程：</p>
<img src="/images/ios/vest/15403733934272.jpg" alt="-w1132" style="zoom:57%;" />

<h3 id="4-2-编译器"><a href="#4-2-编译器" class="headerlink" title="4.2 编译器"></a>4.2 编译器</h3><h4 id="4-2-1-相关名词"><a href="#4-2-1-相关名词" class="headerlink" title="4.2.1 相关名词"></a>4.2.1 相关名词</h4><ul>
<li><p>GCC：（GNU Compiler Collection）缩写，一个编程语言编译器，是GNU（自由软件理事会）的关键部分。也是GNU工具链的一部分。GCC常被认为是跨平台编译器的事实标准，特别是它的C语言编译器。GCC原本只能处理C语言。但是面对Clang的竞争，很快作出了扩展，现在已经可以处理C++，Fortran、Pascal、Object-C、Java、Ada，以及Go语言。许多操作系统，包括许多Unix系统，如Linux及BSD家族都采用GCC作为标准编译器。MacOSX也是采用这个编译器。</p>
</li>
<li><p>LLVM：是Low Level Virtual Machine的简称。这个库提供了与编译器相关的支持，能够进行程序语言的编译期优化、链接优化、在线编译优化、代码生成。可以作为多种语言编译器的后台来使用。</p>
</li>
<li><p>Clang：Clang 是 LLVM 的子项目，是 C，C++ 和 Objective-C 编译器，目的是提供惊人的快速编译，比 GCC 快3倍，其中的 clang static analyzer 主要是进行语法分析，语义分析和生成中间代码，当然这个过程会对代码进行检查，出错的和需要警告的会标注出来。</p>
</li>
<li><p>前端编译器：编译器前端的任务是进行：语法分析，语义分析，生成中间代码(intermediate representation )。在这个过程中，会进行类型检查，如果发现错误或者警告会标注出来在哪一行。</p>
</li>
</ul>
<img src="/images/ios/vest/15403735367044.jpg" style="zoom:55%;" />

<ul>
<li>后端编译器：编译器后端会进行机器无关的代码优化，生成机器语言，并且进行机器相关的代码优化。iOS的编译过程，后端的处理如下</li>
</ul>
<p>LVVM 优化器会进行 BitCode 的生成，链接期优化等等。 </p>
<img src="/images/ios/vest/15403741982298.jpg" style="zoom:55%;" />

<p>LLVM机器码生成器会针对不同的架构，比如arm64等生成不同的机器码。</p>
<img src="/images/ios/vest/15403742042150.jpg" style="zoom:55%;" />

<p>2000年，伊利诺伊大学厄巴纳－香槟分校（University of Illinois at Urbana-Champaign 简称UIUC）这所享有世界声望的一流公立研究型大学的 <strong>Chris Lattner</strong>（他的 twitter <a target="_blank" rel="noopener" href="https://twitter.com/clattner_llvm">@clattner_llvm</a> ） 开发了一个叫作 Low Level Virtual Machine 的编译器开发工具套件，后来涉及范围越来越大，可以用于常规编译器，JIT编译器，汇编器，调试器，静态分析工具等一系列跟编程语言相关的工作，于是就把简称 LLVM 这个简称作为了正式的名字。Chris Lattner 后来又开发了 Clang，使得 LLVM 直接挑战 GCC 的地位。2012年，LLVM 获得美国计算机学会 ACM 的软件系统大奖，和 UNIX，WWW，TCP/IP，Tex，JAVA 等齐名。</p>
<p>Chris Lattner 生于 1978 年，2005年加入苹果，将苹果使用的 GCC 全面转为 LLVM。2010年开始主导开发 Swift 语言。</p>
<p>iOS 开发中 Objective-C 是 Clang / LLVM 来编译的。</p>
<h3 id="4-3-Hikari"><a href="#4-3-Hikari" class="headerlink" title="4.3 Hikari"></a>4.3 Hikari</h3><p><a target="_blank" rel="noopener" href="https://github.com/HikariObfuscator/Hikari">Hikari</a> 是一个基于 <a target="_blank" rel="noopener" href="https://github.com/obfuscator-llvm/obfuscator">Obfuscator-LLVM</a> 对 Xcode9的适配。</p>
<p>OLLVM 是瑞士西北应用科技大学安全实验室于2010年6月份发起的一个项目，该项目旨在提供一套开源的针对 LLVM 的代码混淆工具，以增加对逆向工程的难度。目前，OLLVM已经支持LLVM-4.0版本。</p>
<h4 id="4-3-1-安装"><a href="#4-3-1-安装" class="headerlink" title="4.3.1 安装"></a>4.3.1 安装</h4><p>下载 github 提供的 pkg 安装文件并双击安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/HikariObfuscator/Hikari/releases</span><br></pre></td></tr></table></figure>

<p>然后重启 Xcode 就能看到已经有 Kikari 编译工具</p>
<img src="/images/ios/vest/15403757992100.jpg" alt="-w640" style="zoom:67%;" />


<h4 id="4-3-2-使用"><a href="#4-3-2-使用" class="headerlink" title="4.3.2 使用"></a>4.3.2 使用</h4><ol>
<li><code>Xcode</code> -&gt; <code>Toolchains</code> -&gt; <code>Hikari</code> 将混淆工具和项目关联</li>
<li>将所有与要运行的 target 相关的 target（包括pod进来的库）<code>Enable Index-While-Building</code> 的值改为 <em>NO</em>。</li>
<li><code>Optimization Level</code> 的值设置为 <code>None[-O0]</code></li>
<li>在 <code>Build Settings</code> -&gt; <code>Other C Flags</code> 中加入混淆标记</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-mllvm -enable-bcfobf 		启用伪控制流  </span><br><span class="line">-mllvm -enable-cffobf 		启用控制流平坦化</span><br><span class="line">-mllvm -enable-splitobf 	启用基本块分割  </span><br><span class="line">-mllvm -enable-subobf 		启用指令替换  </span><br><span class="line">-mllvm -enable-acdobf 		启用反class-dump  </span><br><span class="line">-mllvm -enable-indibran 	启用基于寄存器的相对跳转，配合其他加固可以彻底破坏IDA/Hopper的伪代码(俗称F5)  </span><br><span class="line">-mllvm -enable-strcry 		启用字符串加密  </span><br><span class="line">-mllvm -enable-funcwra 		启用函数封装</span><br><span class="line">-mllvm -enable-allob      依次性启用上述所有标记</span><br></pre></td></tr></table></figure>


<p>重新编译就会使用 Hikari 在编译器后端对项目进行编译了。</p>
<p>将编译后的二进制文件拖入 hopper 中进行对比</p>
<img src="/images/ios/vest/15403763613907.jpg" alt="-w1194" style="zoom:57%;" />

<p>发现代码已经被混淆过了。</p>
<p><strong>最新的 Xcode10 通过非官方默认的 Toolchains 编译后的的 ipa 是拒绝提交审核的。</strong></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>以上是对 iOS 下马甲包，代码混淆，编译混淆的一些学习实践，实际使用中需要根据自己的实际需求进行调整尝试。 </p>
<p>demo 地址：<a target="_blank" rel="noopener" href="https://github.com/huanglins/iOSObfuscator">iOSObfuscator</a></p>
<p>加密与破解，编译与反编译永远都是在不停攻防的。没有一堵绝对安全的墙，也没有绝对完美的银弹。只有在开发成本与安全成本中找个一个平衡，才是可持续发展的选择。</p>
<h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><ul>
<li>马甲包<ul>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/339c62db048f">马甲包</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/klaus01/KLGenerateSpamCode">KLGenerateSpamCode</a></li>
</ul>
</li>
<li>逆向基础，为什么要混淆<ul>
<li><a target="_blank" rel="noopener" href="http://www.cocoachina.com/mac/20150122/10988.html">了解iOS上的可执行文件和Mach-O格式</a></li>
</ul>
</li>
<li>类名/方法混淆<ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/yiyaaixuexi/article/details/29201699">iOS安全攻防（二十三）：Objective-C代码混淆</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/19bf42f22473">iOS代码混淆</a></li>
</ul>
</li>
<li>编译混淆<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/ming1016/study/wiki/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90-iOS-%E7%BC%96%E8%AF%91-Clang---LLVM">深入剖析 iOS 编译 Clang LLVM</a></li>
<li><a target="_blank" rel="noopener" href="https://juejin.im/post/5ba05c3c6fb9a05d31550275">iOS混淆笔记</a></li>
<li><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzUxMzcxMzE5Ng==&mid=2247488360&amp;idx=1&amp;sn=94fba30a87d0f9bc0b9ff94d3fed3386&source=41#wechat_redirect">基于clang插件的一种iOS包大小瘦身方案</a></li>
<li><a target="_blank" rel="noopener" href="https://juejin.im/post/5ba05c3c6fb9a05d31550275">iOS混淆笔记</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/a631b5584de6">Obfuscator-LLVM在iOS中的实践</a></li>
</ul>
</li>
<li>审核<ul>
<li><a target="_blank" rel="noopener" href="https://juejin.im/post/5bbaba595188255c9f06cdfd?utm_source=gold_browser_extension">一篇文章讲清如何应对 App Store 审核 2.1 大礼包</a></li>
</ul>
</li>
</ul>

    </article>
    <!-- license  -->
    
        <div class="license-wrapper">
            <p>Author：<a href="https://tenloy.github.io">Tenloy</a>
            <p>原文链接：<a href="https://tenloy.github.io/2020/06/13/ios-vest.html">https://tenloy.github.io/2020/06/13/ios-vest.html</a>
            <p>发表日期：2020.06.13 , 11:30 AM</p>
            <p>更新日期：2023.05.04 , 6:02 PM</p>
            <p>版权声明：本文采用<a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc/4.0/">Crative Commons 4.0 许可协议</a>进行许可</p>
        </div>
    
    <!-- paginator  -->
    <ul class="post-paginator">
        <li class="next">
            
                <div class="nextSlogan">Next Post</div>
                <a href= "/2020/07/01/ios-apns.html" title= "iOS APNS接收逻辑梳理">
                    <div class="nextTitle">iOS APNS接收逻辑梳理</div>
                </a>
            
        </li>
        <li class="previous">
            
        </li>
    </ul>
    <!-- 评论插件 -->
    <!-- 来必力City版安装代码 -->

<!-- City版安装代码已完成 -->
    
    
    <!-- gitalk评论 -->

    <!-- utteranc评论 -->

    <!-- partial('_partial/comment/changyan') -->
    <!--PC版-->


    
    

    <!-- 评论 -->
</main>
            <!-- profile -->
            
        </div>
        <footer class="footer footer-unloaded">
    <!-- social  -->
    
    <div class="social">
        
    
        
            
                <a href="mailto:luotengoto@163.com" class="iconfont-archer email" title=email ></a>
            
        
    
        
            
                <a href="//github.com/Tenloy" class="iconfont-archer github" target="_blank" title=github></a>
            
        
    
        
            
                <a href="https://www.jianshu.com/u/8db1bc12db9f" class="iconfont-jian jianshu" target="_blank" title=jianshu></a>
            
        
    
        
            
                <a href="/atom.xml" class="iconfont-archer rss" target="_blank" title=rss></a>
            
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    

    </div>
    
    <!-- powered by Hexo  -->
    <div class="copyright">
        <span id="hexo-power">Powered by <a href="https://hexo.io/" target="_blank">Hexo</a></span><span class="iconfont-archer power">&#xe635;</span><span id="theme-info">theme <a href="https://github.com/fi3ework/hexo-theme-archer" target="_blank">Archer</a></span>
    </div>
    <!-- 不蒜子  -->
    
    <div class="busuanzi-container">
    
     
    <span id="busuanzi_container_site_pv">PV: <span id="busuanzi_value_site_pv"></span> :)</span>
    
    </div>
    
</footer>
    </div>
    <!-- toc -->
    
    <div class="toc-wrapper" style=
    







top:40vh;

    >
        <div class="toc-catalog">
            <span class="iconfont-archer catalog-icon">&#xe613;</span><span>CATALOG</span>
        </div>
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E4%B8%BA%E4%BB%80%E4%B9%88%E5%88%B6%E4%BD%9C%E9%A9%AC%E7%94%B2%EF%BC%9F"><span class="toc-text">一、为什么制作马甲？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E8%A7%A3%E5%86%B3%E4%B8%A4%E4%B8%AA%E9%97%AE%E9%A2%98"><span class="toc-text">二、解决两个问题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-%E8%84%9A%E6%9C%AC%E6%B7%B7%E6%B7%86"><span class="toc-text">2.1 脚本混淆</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-%E6%89%8B%E5%8A%A8%E6%B7%B7%E6%B7%86"><span class="toc-text">2.2 手动混淆</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-1-%E6%80%9D%E8%B7%AF"><span class="toc-text">2.2.1 思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-2-KLGenerateSpamCode"><span class="toc-text">2.2.2 KLGenerateSpamCode</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%AE%A1%E6%A0%B8%E6%B5%81%E7%A8%8B"><span class="toc-text">三、审核流程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-%E6%9C%BA%E5%AE%A1"><span class="toc-text">3.1 机审</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-%E4%BA%BA%E5%AE%A1"><span class="toc-text">3.2 人审</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-%E5%AE%A1%E6%A0%B8%E8%A2%AB%E6%8B%92%E5%A4%84%E7%90%86"><span class="toc-text">3.3 审核被拒处理</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E3%80%81App%E9%85%8D%E7%BD%AE%E5%A4%9A%E4%B8%AA%E9%A9%AC%E7%94%B2%E5%8C%85%E7%9A%84%E7%8E%AF%E5%A2%83"><span class="toc-text">四、App配置多个马甲包的环境</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%99%84%E4%B8%80%E7%AF%87%E5%AE%9E%E6%93%8D%E6%96%87%E7%AB%A0"><span class="toc-text">附一篇实操文章</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E9%A9%AC%E7%94%B2%E5%8C%85"><span class="toc-text">1. 马甲包</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E4%BB%80%E4%B9%88%E6%98%AF%E9%A9%AC%E7%94%B2%E5%8C%85"><span class="toc-text">1.1 什么是马甲包?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E4%B8%BA%E4%BB%80%E4%B9%88%E5%81%9A%E9%A9%AC%E7%94%B2%E5%8C%85%EF%BC%8C%E4%BB%A5%E5%8F%8A%E9%A9%AC%E7%94%B2%E5%8C%85%E7%9A%84%E5%A5%BD%E5%A4%84"><span class="toc-text">1.2 为什么做马甲包，以及马甲包的好处</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E9%A9%AC%E7%94%B2%E5%8C%85%E5%88%B6%E4%BD%9C%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-text">1.3 马甲包制作注意事项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-%E5%AE%9E%E8%B7%B5"><span class="toc-text">1.4 实践</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-%E4%BC%98%E5%8C%96%E5%9B%BE%E7%89%87%E5%A4%A7%E5%B0%8F%EF%BC%8C%E4%BF%AE%E6%94%B9%E5%9B%BE%E7%89%87-hash-%E5%80%BC"><span class="toc-text">1.5 优化图片大小，修改图片 hash 值</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E9%80%86%E5%90%91%E5%9F%BA%E7%A1%80%EF%BC%8C%E4%BB%A5%E5%8F%8A%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%81%9A%E6%B7%B7%E6%B7%86"><span class="toc-text">2. 逆向基础，以及为什么要做混淆</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-Mach-%E4%B8%8E-Mach-O"><span class="toc-text">2.1 Mach 与 Mach-O</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-iOS-%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6"><span class="toc-text">2.2 iOS 可执行文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-class-dump"><span class="toc-text">2.3 class-dump</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8"><span class="toc-text">2.4 安装使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-hopper"><span class="toc-text">2.5 hopper</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E4%BB%A3%E7%A0%81%E6%B7%B7%E6%B7%86"><span class="toc-text">3. 代码混淆</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E6%9B%BF%E6%8D%A2%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%B7%B7%E6%B7%86"><span class="toc-text">3.1 替换字符串混淆</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E6%9F%A5%E7%9C%8B%E7%BC%96%E8%AF%91%E7%BB%93%E6%9E%9C"><span class="toc-text">3.2 查看编译结果</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E7%BC%96%E8%AF%91%E6%B7%B7%E6%B7%86"><span class="toc-text">4. 编译混淆</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-iOS-%E6%98%AF%E5%A6%82%E4%BD%95%E7%BC%96%E8%AF%91%E7%9A%84"><span class="toc-text">4.1 iOS 是如何编译的</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E7%BC%96%E8%AF%91%E5%99%A8"><span class="toc-text">4.2 编译器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-1-%E7%9B%B8%E5%85%B3%E5%90%8D%E8%AF%8D"><span class="toc-text">4.2.1 相关名词</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-Hikari"><span class="toc-text">4.3 Hikari</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-1-%E5%AE%89%E8%A3%85"><span class="toc-text">4.3.1 安装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-2-%E4%BD%BF%E7%94%A8"><span class="toc-text">4.3.2 使用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-text">总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0"><span class="toc-text">参考文章</span></a></li></ol></li></ol>
    </div>
    
    <div class="back-top iconfont-archer">&#xe639;</div>
    <div class="sidebar sidebar-hide">
    <ul class="sidebar-tabs sidebar-tabs-active-0">
        <li class="sidebar-tab-categories"><span class="iconfont-archer">&#xe666;</span><span class="tab-name">Cate</span></li>
        <li class="sidebar-tab-archives"><span class="iconfont-archer">&#xe67d;</span><span class="tab-name">Archive</span></li>
        <li class="sidebar-tab-tags"><span class="iconfont-archer">&#xe61b;</span><span class="tab-name">Tag</span></li>
    </ul>
    <div class="sidebar-content sidebar-content-show-archive">
        <div class="sidebar-panel-categories">
    <div class="sidebar-categories-name">
    
    
    
    
    
        <span class="sidebar-category-name" data-categories="数据结构与算法"><span class="iconfont-archer">&#xe60a;</span>数据结构与算法</span>
    
        <span class="sidebar-category-name" data-categories="计算机组成原理"><span class="iconfont-archer">&#xe60a;</span>计算机组成原理</span>
    
        <span class="sidebar-category-name" data-categories="计算机网络"><span class="iconfont-archer">&#xe60a;</span>计算机网络</span>
    
        <span class="sidebar-category-name" data-categories="汇编语言"><span class="iconfont-archer">&#xe60a;</span>汇编语言</span>
    
        <span class="sidebar-category-name" data-categories="数据的存储与传输"><span class="iconfont-archer">&#xe60a;</span>数据的存储与传输</span>
    
        <span class="sidebar-category-name" data-categories="操作系统"><span class="iconfont-archer">&#xe60a;</span>操作系统</span>
    
        <span class="sidebar-category-name" data-categories="互联网标准RFC"><span class="iconfont-archer">&#xe60a;</span>互联网标准RFC</span>
    
        <span class="sidebar-category-name" data-categories="编译链接与装载"><span class="iconfont-archer">&#xe60a;</span>编译链接与装载</span>
    
        <span class="sidebar-category-name" data-categories="iOS"><span class="iconfont-archer">&#xe60a;</span>iOS</span>
    
        <span class="sidebar-category-name" data-categories="架构与设计模式"><span class="iconfont-archer">&#xe60a;</span>架构与设计模式</span>
    
        <span class="sidebar-category-name" data-categories="图形处理与渲染"><span class="iconfont-archer">&#xe60a;</span>图形处理与渲染</span>
    
        <span class="sidebar-category-name" data-categories="软件工程"><span class="iconfont-archer">&#xe60a;</span>软件工程</span>
    
        <span class="sidebar-category-name" data-categories="音视频处理"><span class="iconfont-archer">&#xe60a;</span>音视频处理</span>
    
        <span class="sidebar-category-name" data-categories="DSL"><span class="iconfont-archer">&#xe60a;</span>DSL</span>
    
        <span class="sidebar-category-name" data-categories="Swift"><span class="iconfont-archer">&#xe60a;</span>Swift</span>
    
        <span class="sidebar-category-name" data-categories="Git"><span class="iconfont-archer">&#xe60a;</span>Git</span>
    
        <span class="sidebar-category-name" data-categories="Web"><span class="iconfont-archer">&#xe60a;</span>Web</span>
    
    </div>
    <div class="iconfont-archer sidebar-categories-empty">&#xe678;</div>
    <div class="sidebar-categories-list"></div>
</div>
          <div class="sidebar-panel-archives">
    <!-- 在ejs中将archive按照时间排序 -->
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <div class="total-and-search">
        <div class="total-archive">
        Total : 76
        </div>
        <!-- search  -->
        
            <div class="site-search popup-trigger tl-side-search"> 
                <span class="iconfont-jian search-icon">&#xe7fc;搜索</span>
            </div>
        
    </div>
    
    <div class="post-archive">
    
    
    
    
    <div class="archive-year"> 2022 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/05</span><a class="archive-post-title" href= "/2022/05/05/sqlite.html" >iOS SQLite的使用与优化</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/28</span><a class="archive-post-title" href= "/2022/04/28/mmap.html" >内存映射mmap函数的原理与应用</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/18</span><a class="archive-post-title" href= "/2022/03/18/avfoundation.html" >AVFoundation Programming Guide(译)</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/17</span><a class="archive-post-title" href= "/2022/03/17/avframework.html" >iOS音视频库概述</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/09</span><a class="archive-post-title" href= "/2022/02/09/OAuth.html" >[转] OAuth 2.0简述</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/18</span><a class="archive-post-title" href= "/2022/01/18/wkwebview-buges.html" >WKWebView使用过程中遇到的坑</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2021 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/22</span><a class="archive-post-title" href= "/2021/11/22/bit-calculation.html" >[转] 位运算实现加、减、乘、除运算</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/10</span><a class="archive-post-title" href= "/2021/11/10/git-use.html" >Git的使用总结</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/21</span><a class="archive-post-title" href= "/2021/10/21/dyld-objc.html" >(七) dyld与Objc—_objc_init、map_images、load_images</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/18</span><a class="archive-post-title" href= "/2021/10/18/compile-dynamic-link.html" >(六) Mach-O 文件的动态链接、库、Dyld(含dlopen)</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/14</span><a class="archive-post-title" href= "/2021/10/14/compile-vm-asrl.html" >(五) Mach-O 文件之进程(虚拟)地址空间、ASLR</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/10</span><a class="archive-post-title" href= "/2021/10/10/compile-load.html" >(四) Mach-O 文件的装载</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/08</span><a class="archive-post-title" href= "/2021/10/08/compile-static-link.html" >(三) Mach-O 文件的静态链接</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/06</span><a class="archive-post-title" href= "/2021/10/06/compile-macho.html" >(二) Mach-O 文件结构</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/05</span><a class="archive-post-title" href= "/2021/10/05/compile-clang-llvm.html" >(一) Clang/LLVM 介绍、OC 程序的编译过程</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/02</span><a class="archive-post-title" href= "/2021/10/02/makefile.html" >[转] Make 命令的使用与NodeJS案例</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/28</span><a class="archive-post-title" href= "/2021/09/28/architectural-pattern.html" >常见架构模式: MVC、MVP、MVVM、VIPER</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/25</span><a class="archive-post-title" href= "/2021/09/25/design-pattern.html" >常见的设计模式</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/20</span><a class="archive-post-title" href= "/2021/09/20/program-thought.html" >常见的编程范式</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/15</span><a class="archive-post-title" href= "/2021/09/15/graphics-processing-case.html" >图形处理(三) - 图形处理实践案例</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/15</span><a class="archive-post-title" href= "/2021/09/15/graphics-processing.html" >图形处理(二) - 图形与视频处理相关的框架</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/13</span><a class="archive-post-title" href= "/2021/09/13/image-encode-decode.html" >图形处理(一) - 图片的加载与编解码</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/12</span><a class="archive-post-title" href= "/2021/09/12/iOS-Render.html" >[转] iOS离屏渲染原理及优化</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/11</span><a class="archive-post-title" href= "/2021/09/11/core-animation03.html" >Core-Animation(三) - 渲染流程探究及性能分析</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/09</span><a class="archive-post-title" href= "/2021/09/09/core-animation02.html" >Core Animation(二) - 隐式动画、CATransaction与CAAction</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/07</span><a class="archive-post-title" href= "/2021/09/07/core-animation01.html" >Core Animation(一) - UIView与CALayer、布局与绘制</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/05</span><a class="archive-post-title" href= "/2021/09/05/AFN-Analyse.html" >[转] AFN框架实现解析</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/04</span><a class="archive-post-title" href= "/2021/09/04/nrl-session.html" >NSURLSession概述</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/02</span><a class="archive-post-title" href= "/2021/09/02/Log.html" >移动端日志库设计</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/01</span><a class="archive-post-title" href= "/2021/08/01/Crash-Monitor.html" >iOS崩溃监控与分析</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/30</span><a class="archive-post-title" href= "/2021/07/30/Lag-Monitor.html" >iOS卡顿监控</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/29</span><a class="archive-post-title" href= "/2021/07/29/SwiftUI.html" >SwiftUI</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/29</span><a class="archive-post-title" href= "/2021/07/29/Swift-Version-History.html" >Swift版本更新API介绍</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/26</span><a class="archive-post-title" href= "/2021/07/26/RunLoop-Reposted-From-ibireme.html" >[转] 深入理解RunLoop—ibireme</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/25</span><a class="archive-post-title" href= "/2021/07/25/Protocol-Buffer.html" >Protocol Buffer的基本介绍</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/24</span><a class="archive-post-title" href= "/2021/07/24/base64.html" >Base64编码及iOS中的Base64</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/23</span><a class="archive-post-title" href= "/2021/07/23/chinese-encode.html" >[转] 彻底弄懂常见的7种中文字符编码</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/10</span><a class="archive-post-title" href= "/2021/07/10/p-npc-np.html" >P问题、NP问题、NPC、NP-Hard、P=NP?</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/30</span><a class="archive-post-title" href= "/2021/06/30/probability.html" >(六) 概率算法</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/28</span><a class="archive-post-title" href= "/2021/06/28/branch-bound.html" >(五) 分支限界算法</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/26</span><a class="archive-post-title" href= "/2021/06/26/back-track.html" >(四) 回溯法(试探算法)</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/24</span><a class="archive-post-title" href= "/2021/06/24/greed.html" >(三) 贪心算法</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/22</span><a class="archive-post-title" href= "/2021/06/22/dynamic-programming.html" >(二) 动态规划算法</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/20</span><a class="archive-post-title" href= "/2021/06/20/divide-and-conquer.html" >(一) 分治算法及减治、变治算法</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/18</span><a class="archive-post-title" href= "/2021/06/18/several-programming.html" >穷举、递推、迭代(辗转法)、递归算法</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/15</span><a class="archive-post-title" href= "/2021/06/15/datastruction-overview.html" >数据结构与算法概述</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/06</span><a class="archive-post-title" href= "/2021/06/06/Web-Module.html" >前端各种模块化方案总结</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/27</span><a class="archive-post-title" href= "/2021/05/27/Fiber.html" >[转] 最通俗的 React Fiber(时间分片)</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/27</span><a class="archive-post-title" href= "/2021/05/27/Coroutine.html" >[转] 什么是协程</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/19</span><a class="archive-post-title" href= "/2021/05/19/DSL.html" >[转] 谈谈DSL以及DSL的应用（以CocoaPods 为例）</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/03</span><a class="archive-post-title" href= "/2021/05/03/iOS-private-pod.html" >私有Pod库部署</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/29</span><a class="archive-post-title" href= "/2021/04/29/iOS-ComRouter.html" >[转] iOS的组件化方案</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/27</span><a class="archive-post-title" href= "/2021/04/27/iOS-CI.html" >iOS的持续集成</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/26</span><a class="archive-post-title" href= "/2021/04/26/Containers.html" >常见的容器概念：Linux容器、Docker容器、服务器容器</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/24</span><a class="archive-post-title" href= "/2021/04/24/Dock-Reprinted-from-RuanYIFeng.html" >[转] Docker入门教程</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/20</span><a class="archive-post-title" href= "/2021/04/20/Sync-Async.html" >同步和异步解读及编程中的使用场景</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/17</span><a class="archive-post-title" href= "/2021/04/17/Arm64-Handbook.html" >ARM64指令简易手册</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/16</span><a class="archive-post-title" href= "/2021/04/16/Arm64-Introduce.html" >iOS需要了解的ARM64汇编</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/13</span><a class="archive-post-title" href= "/2021/04/13/Command-Line.html" >CLI Shell、Terminal、脚本(语言)</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/10</span><a class="archive-post-title" href= "/2021/04/10/Ins-SysCall-Kernel-Shell.html" >指令、系统调用、库、Shell、APP的层次关系</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/08</span><a class="archive-post-title" href= "/2021/04/08/ISA-Microarch-Soc.html" >指令集、微架构、手机芯片(Soc)及ARM的介绍</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/02</span><a class="archive-post-title" href= "/2021/04/02/Engineering.html" >工程化、动态化、容器化、组件化</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/01</span><a class="archive-post-title" href= "/2021/04/01/GithubPages-Hexo.html" >使用Hexo+Github Pages搭建个人博客</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2020 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/22</span><a class="archive-post-title" href= "/2020/12/22/aes.html" >数据加密 — 对称加密(以AES为例)</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/21</span><a class="archive-post-title" href= "/2020/12/21/aes-standard.html" >[转] AES标准及Rijndael算法解析</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/20</span><a class="archive-post-title" href= "/2020/12/20/asymmetric.html" >数据加密 — 非对称加密(加签/加密，以RSA为例)</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/09</span><a class="archive-post-title" href= "/2020/12/09/pki.html" >常见的PKI标准(X.509、PKCS)及证书相关介绍</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/28</span><a class="archive-post-title" href= "/2020/10/28/runtime-data-structure.html" >Objc Runtime总结</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/11</span><a class="archive-post-title" href= "/2020/09/11/GCD.html" >Objective-C — 深入浅出GCD常用API</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/06</span><a class="archive-post-title" href= "/2020/09/06/oc-block.html" >Objective-C — Block</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/26</span><a class="archive-post-title" href= "/2020/08/26/AutoreleasePool.html" >AutoreleasePool</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/24</span><a class="archive-post-title" href= "/2020/08/24/oc-memory-manage.html" >Objective-C — 内存管理</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/01</span><a class="archive-post-title" href= "/2020/08/01/ui-navigation-bar.html" >[转] 导航栏的架构介绍及使用</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/15</span><a class="archive-post-title" href= "/2020/07/15/symbol-decl.html" >变量声明、函数声明的作用</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/01</span><a class="archive-post-title" href= "/2020/07/01/ios-apns.html" >iOS APNS接收逻辑梳理</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/13</span><a class="archive-post-title" href= "/2020/06/13/ios-vest.html" >iOS制作马甲总结</a>
        </li>
    
    </div>
  </div>
        <div class="sidebar-panel-tags">
    <div class="sidebar-tags-name">
    
        <span class="sidebar-tag-name" data-tags="AutoreleasePool"><span class="iconfont-archer">&#xe606;</span>AutoreleasePool</span>
    
        <span class="sidebar-tag-name" data-tags="GCD"><span class="iconfont-archer">&#xe606;</span>GCD</span>
    
        <span class="sidebar-tag-name" data-tags="hexo"><span class="iconfont-archer">&#xe606;</span>hexo</span>
    
        <span class="sidebar-tag-name" data-tags="ISA"><span class="iconfont-archer">&#xe606;</span>ISA</span>
    
        <span class="sidebar-tag-name" data-tags="Microarch"><span class="iconfont-archer">&#xe606;</span>Microarch</span>
    
        <span class="sidebar-tag-name" data-tags="Soc"><span class="iconfont-archer">&#xe606;</span>Soc</span>
    
        <span class="sidebar-tag-name" data-tags="CLI"><span class="iconfont-archer">&#xe606;</span>CLI</span>
    
        <span class="sidebar-tag-name" data-tags="Shell"><span class="iconfont-archer">&#xe606;</span>Shell</span>
    
        <span class="sidebar-tag-name" data-tags="ARM64"><span class="iconfont-archer">&#xe606;</span>ARM64</span>
    
        <span class="sidebar-tag-name" data-tags="多线程"><span class="iconfont-archer">&#xe606;</span>多线程</span>
    
        <span class="sidebar-tag-name" data-tags="Docker"><span class="iconfont-archer">&#xe606;</span>Docker</span>
    
        <span class="sidebar-tag-name" data-tags="协程"><span class="iconfont-archer">&#xe606;</span>协程</span>
    
        <span class="sidebar-tag-name" data-tags="DSL"><span class="iconfont-archer">&#xe606;</span>DSL</span>
    
        <span class="sidebar-tag-name" data-tags="Fiber"><span class="iconfont-archer">&#xe606;</span>Fiber</span>
    
        <span class="sidebar-tag-name" data-tags="dp"><span class="iconfont-archer">&#xe606;</span>dp</span>
    
        <span class="sidebar-tag-name" data-tags="SwiftUI"><span class="iconfont-archer">&#xe606;</span>SwiftUI</span>
    
        <span class="sidebar-tag-name" data-tags="Swift-Syntax"><span class="iconfont-archer">&#xe606;</span>Swift-Syntax</span>
    
        <span class="sidebar-tag-name" data-tags="RunLoop"><span class="iconfont-archer">&#xe606;</span>RunLoop</span>
    
        <span class="sidebar-tag-name" data-tags="LagMonitor"><span class="iconfont-archer">&#xe606;</span>LagMonitor</span>
    
        <span class="sidebar-tag-name" data-tags="CrashMonitor"><span class="iconfont-archer">&#xe606;</span>CrashMonitor</span>
    
        <span class="sidebar-tag-name" data-tags="Log"><span class="iconfont-archer">&#xe606;</span>Log</span>
    
        <span class="sidebar-tag-name" data-tags="AFN"><span class="iconfont-archer">&#xe606;</span>AFN</span>
    
    </div>
    <div class="iconfont-archer sidebar-tags-empty">&#xe678;</div>
    <div class="tag-load-fail" style="display: none; color: #ccc; font-size: 0.6rem;">
    缺失模块。<br/>
    1、请确保node版本大于6.2<br/>
    2、在博客根目录（注意不是archer根目录）执行以下命令：<br/>
    <span style="color: #f75357; font-size: 1rem; line-height: 2rem;">npm i hexo-generator-json-content --save</span><br/>
    3、在根目录_config.yml里添加配置：
    <pre style="color: #787878; font-size: 0.6rem;">
jsonContent:
  meta: false
  pages: false
  posts:
    title: true
    date: true
    path: true
    text: false
    raw: false
    content: false
    slug: false
    updated: false
    comments: false
    link: false
    permalink: false
    excerpt: false
    categories: true
    tags: true</pre>
    </div> 
    <div class="sidebar-tags-list"></div>
</div>
    </div>
</div> 
    <script>
    var siteMeta = {
        root: "/",
        author: "Tenloy"
    }
</script>
    <!-- CDN failover -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
    <script type="text/javascript">
        if (typeof window.$ === 'undefined')
        {
            console.warn('jquery load from jsdelivr failed, will load local script')
            document.write('<script src="/lib/jquery.min.js">\x3C/script>')
        }
    </script>
    <script src="/scripts/main.js"></script>
    <!-- algolia -->
    
        <div class="site-search">
  <div class="algolia-popup popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="iconfont-archer">&#xe609;</i>
    </span>
  </div>
</div>
        <script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.8.0/dist/instantsearch.min.js" defer></script>
        <script src="/scripts/search.js" defer></script>
    
    <!-- busuanzi  -->
    
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    <!-- CNZZ  -->
    
    </div>
    <!-- async load share.js -->
    
        <script src="/scripts/share.js" async></script>    
     
    </body>
</html>


